<?xml version="1.0" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../../displayToc.js"></script>
<script language="JavaScript" src="../../tocParas.js"></script>
<script language="JavaScript" src="../../tocTab.js"></script>
<link rel="stylesheet" type="text/css" href="../../scineplex.css">
<title>Win32::NetAdmin - Manage network groups and users in Perl</title>
<link rel="stylesheet" href="../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:" />
</head>

<body>


<!-- INDEX BEGIN -->
<div name="index">
<script>writelinks('__top__',2);</script>
<h1><a>Win32::NetAdmin - Manage network groups and users in Perl</a></h1>
<p><a name="__index__"></a></p>


<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<li><a href="#functions">FUNCTIONS</a></li>
	<ul>

		<li><a href="#note">NOTE</a></li>
	</ul>

	<li><a href="#example">EXAMPLE</a></li>
</ul>

<hr name="index" />
</div>
<!-- INDEX END -->

<p>
</p>
<h1><a name="name">NAME</a></h1>
<p>Win32::NetAdmin - Manage network groups and users in Perl</p>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<pre>
        <span class="keyword">use</span> <span class="variable">Win32::NetAdmin</span><span class="operator">;</span>
</pre>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p>This module offers control over the administration of groups and users over a
network.</p>
<p>
</p>
<hr />
<h1><a name="functions">FUNCTIONS</a></h1>
<p>
</p>
<h2><a name="note">NOTE</a></h2>
<p>All of the functions return false if they fail, unless otherwise noted.
When a function fails call Win32::NetAdmin::GetError() rather than
<code>GetLastError()</code> or $^E to retrieve the error code.</p>
<p><code>server</code> is optional for all the calls below. If not given the local machine is
assumed.</p>
<dl>
<dt><strong><a name="geterror" class="item"><code>GetError()</code></a></strong>

<dd>
<p>Returns the error code of the last call to this module.</p>
</dd>
</li>
<dt><strong><a name="getdomaincontroller" class="item">GetDomainController(server, domain, returnedName)</a></strong>

<dd>
<p>Returns the name of the domain controller for server.</p>
</dd>
</li>
<dt><strong><a name="getanydomaincontroller" class="item">GetAnyDomainController(server, domain, returnedName)</a></strong>

<dd>
<p>Returns the name of any domain controller for a domain that is directly trusted
by the server.</p>
</dd>
</li>
<dt><strong><a name="usercreate" class="item">UserCreate(server, userName, password, passwordAge, privilege, homeDir, comment, flags, scriptPath)</a></strong>

<dd>
<p>Creates a user on server with password, passwordAge, privilege, homeDir, comment,
flags, and scriptPath.</p>
</dd>
</li>
<dt><strong><a name="userdelete" class="item">UserDelete(server, user)</a></strong>

<dd>
<p>Deletes a user from server.</p>
</dd>
</li>
<dt><strong><a name="usergetattributes" class="item">UserGetAttributes(server, userName, password, passwordAge, privilege, homeDir, comment, flags, scriptPath)</a></strong>

<dd>
<p>Gets password, passwordAge, privilege, homeDir, comment, flags, and scriptPath
for user.</p>
</dd>
</li>
<dt><strong><a name="usersetattributes" class="item">UserSetAttributes(server, userName, password, passwordAge, privilege, homeDir, comment, flags, scriptPath)</a></strong>

<dd>
<p>Sets password, passwordAge, privilege, homeDir, comment, flags, and scriptPath
for user.</p>
</dd>
</li>
<dt><strong><a name="userchangepassword" class="item">UserChangePassword(domainname, username, oldpassword, newpassword)</a></strong>

<dd>
<p>Changes a users password. Can be run under any account.</p>
</dd>
</li>
<dt><strong><a name="usersexist" class="item">UsersExist(server, userName)</a></strong>

<dd>
<p>Checks if a user exists.</p>
</dd>
</li>
<dt><strong><a name="getusers" class="item">GetUsers(server, filter, userRef)</a></strong>

<dd>
<p>Fills userRef with user names if it is an array reference and with the user
names and the full names if it is a hash reference.</p>
</dd>
</li>
<dt><strong><a name="groupcreate" class="item">GroupCreate(server, group, comment)</a></strong>

<dd>
<p>Creates a group.</p>
</dd>
</li>
<dt><strong><a name="groupdelete" class="item">GroupDelete(server, group)</a></strong>

<dd>
<p>Deletes a group.</p>
</dd>
</li>
<dt><strong><a name="groupgetattributes" class="item">GroupGetAttributes(server, groupName, comment)</a></strong>

<dd>
<p>Gets the comment.</p>
</dd>
</li>
<dt><strong><a name="groupsetattributes" class="item">GroupSetAttributes(server, groupName, comment)</a></strong>

<dd>
<p>Sets the comment.</p>
</dd>
</li>
<dt><strong><a name="groupaddusers" class="item">GroupAddUsers(server, groupName, users)</a></strong>

<dd>
<p>Adds a user to a group.</p>
</dd>
</li>
<dt><strong><a name="groupdeleteusers" class="item">GroupDeleteUsers(server, groupName, users)</a></strong>

<dd>
<p>Deletes a users from a group.</p>
</dd>
</li>
<dt><strong><a name="groupismember" class="item">GroupIsMember(server, groupName, user)</a></strong>

<dd>
<p>Returns TRUE if user is a member of groupName.</p>
</dd>
</li>
<dt><strong><a name="groupgetmembers" class="item">GroupGetMembers(server, groupName, userArrayRef)</a></strong>

<dd>
<p>Fills userArrayRef with the members of groupName.</p>
</dd>
</li>
<dt><strong><a name="localgroupcreate" class="item">LocalGroupCreate(server, group, comment)</a></strong>

<dd>
<p>Creates a local group.</p>
</dd>
</li>
<dt><strong><a name="localgroupdelete" class="item">LocalGroupDelete(server, group)</a></strong>

<dd>
<p>Deletes a local group.</p>
</dd>
</li>
<dt><strong><a name="localgroupgetattributes" class="item">LocalGroupGetAttributes(server, groupName, comment)</a></strong>

<dd>
<p>Gets the comment.</p>
</dd>
</li>
<dt><strong><a name="localgroupsetattributes" class="item">LocalGroupSetAttributes(server, groupName, comment)</a></strong>

<dd>
<p>Sets the comment.</p>
</dd>
</li>
<dt><strong><a name="localgroupismember" class="item">LocalGroupIsMember(server, groupName, user)</a></strong>

<dd>
<p>Returns TRUE if user is a member of groupName.</p>
</dd>
</li>
<dt><strong><a name="localgroupgetmembers" class="item">LocalGroupGetMembers(server, groupName, userArrayRef)</a></strong>

<dd>
<p>Fills userArrayRef with the members of groupName.</p>
</dd>
</li>
<dt><strong><a name="localgroupgetmemberswithdomain" class="item">LocalGroupGetMembersWithDomain(server, groupName, userRef)</a></strong>

<dd>
<p>This function is similar LocalGroupGetMembers but accepts an array or
a hash reference. Unlike LocalGroupGetMembers it returns each user name
as <code>DOMAIN\USERNAME</code>. If a hash reference is given, the function
returns to each user or group name the type (group, user, alias etc.).
The possible types are as follows:</p>
</dd>
<dd>
<pre>
  <span class="variable">$SidTypeUser</span> <span class="operator">=</span> <span class="number">1</span><span class="operator">;</span>
  <span class="variable">$SidTypeGroup</span> <span class="operator">=</span> <span class="number">2</span><span class="operator">;</span>
  <span class="variable">$SidTypeDomain</span> <span class="operator">=</span> <span class="number">3</span><span class="operator">;</span>
  <span class="variable">$SidTypeAlias</span> <span class="operator">=</span> <span class="number">4</span><span class="operator">;</span>
  <span class="variable">$SidTypeWellKnownGroup</span> <span class="operator">=</span> <span class="number">5</span><span class="operator">;</span>
  <span class="variable">$SidTypeDeletedAccount</span> <span class="operator">=</span> <span class="number">6</span><span class="operator">;</span>
  <span class="variable">$SidTypeInvalid</span> <span class="operator">=</span> <span class="number">7</span><span class="operator">;</span>
  <span class="variable">$SidTypeUnknown</span> <span class="operator">=</span> <span class="number">8</span><span class="operator">;</span>
</pre>
</dd>
</li>
<dt><strong><a name="localgroupaddusers" class="item">LocalGroupAddUsers(server, groupName, users)</a></strong>

<dd>
<p>Adds a user to a group.</p>
</dd>
</li>
<dt><strong><a name="localgroupdeleteusers" class="item">LocalGroupDeleteUsers(server, groupName, users)</a></strong>

<dd>
<p>Deletes a users from a group.</p>
</dd>
</li>
<dt><strong><a name="getservers" class="item">GetServers(server, domain, flags, serverRef)</a></strong>

<dd>
<p>Gets an array of server names or an hash with the server names and the
comments as seen in the Network Neighborhood or the server manager.
For flags, see SV_TYPE_* constants.</p>
</dd>
</li>
<dt><strong><a name="gettransports" class="item">GetTransports(server, transportRef)</a></strong>

<dd>
<p>Enumerates the network transports of a computer. If transportRef is an array
reference, it is filled with the transport names. If transportRef is a hash
reference then a hash of hashes is filled with the data for the transports.</p>
</dd>
</li>
<dt><strong><a name="loggedonusers" class="item">LoggedOnUsers(server, userRef)</a></strong>

<dd>
<p>Gets an array or hash with the users logged on at the specified computer. If
userRef is a hash reference, the value is a semikolon separated string of
username, logon domain and logon server.</p>
</dd>
</li>
<dt><strong><a name="getaliasfromrid" class="item">GetAliasFromRID(server, RID, returnedName)</a></strong>

<dt><strong><a name="getusergroupfromrid" class="item">GetUserGroupFromRID(server, RID, returnedName)</a></strong>

<dd>
<p>Retrieves the name of an alias (i.e local group) or a user group for a RID
from the specified server. These functions can be used for example to get the
account name for the administrator account if it is renamed or localized.</p>
</dd>
<dd>
<p>Possible values for <code>RID</code>:</p>
</dd>
<dd>
<pre>
  DOMAIN_ALIAS_RID_ACCOUNT_OPS
  DOMAIN_ALIAS_RID_ADMINS
  DOMAIN_ALIAS_RID_BACKUP_OPS
  DOMAIN_ALIAS_RID_GUESTS
  DOMAIN_ALIAS_RID_POWER_USERS
  DOMAIN_ALIAS_RID_PRINT_OPS
  DOMAIN_ALIAS_RID_REPLICATOR
  DOMAIN_ALIAS_RID_SYSTEM_OPS
  DOMAIN_ALIAS_RID_USERS
  DOMAIN_GROUP_RID_ADMINS
  DOMAIN_GROUP_RID_GUESTS
  DOMAIN_GROUP_RID_USERS
  DOMAIN_USER_RID_ADMIN
  DOMAIN_USER_RID_GUEST</pre>
</dd>
</li>
<dt><strong><a name="getserverdisks" class="item">GetServerDisks(server, arrayRef)</a></strong>

<dd>
<p>Returns an array with the disk drives of the specified server. The array
contains two-character strings (drive letter followed by a colon).</p>
</dd>
</li>
</dl>
<p>
</p>
<hr />
<h1><a name="example">EXAMPLE</a></h1>
<pre>
    <span class="comment"># Simple script using Win32::NetAdmin to set the login script for</span>
    <span class="comment"># all members of the NT group "Domain Users".  Only works if you</span>
    <span class="comment"># run it on the PDC. (From Robert Spier &lt;rspier@seas.upenn.edu&gt;)</span>
    <span class="comment">#</span>
    <span class="comment"># FILTER_TEMP_DUPLICATE_ACCOUNTS</span>
    <span class="comment">#   Enumerates local user account data on a domain controller.</span>
    <span class="comment">#</span>
    <span class="comment"># FILTER_NORMAL_ACCOUNT</span>
    <span class="comment">#   Enumerates global user account data on a computer.</span>
    <span class="comment">#</span>
    <span class="comment"># FILTER_INTERDOMAIN_TRUST_ACCOUNT</span>
    <span class="comment">#   Enumerates domain trust account data on a domain controller.</span>
    <span class="comment">#</span>
    <span class="comment"># FILTER_WORKSTATION_TRUST_ACCOUNT</span>
    <span class="comment">#   Enumerates workstation or member server account data on a domain</span>
    <span class="comment">#   controller.</span>
    <span class="comment">#</span>
    <span class="comment"># FILTER_SERVER_TRUST_ACCOUNT</span>
    <span class="comment">#   Enumerates domain controller account data on a domain controller.</span>
</pre>
<pre>
    <span class="keyword">use</span> <span class="variable">Win32::NetAdmin</span> <span class="string">qw(GetUsers GroupIsMember
                           UserGetAttributes UserSetAttributes)</span><span class="operator">;</span>
</pre>
<pre>
    <span class="keyword">my</span> <span class="variable">%hash</span><span class="operator">;</span>
    <span class="variable">GetUsers</span><span class="operator">(</span><span class="string">""</span><span class="operator">,</span> <span class="variable">FILTER_NORMAL_ACCOUNT</span> <span class="operator">,</span> <span class="operator">\</span><span class="variable">%hash</span><span class="operator">)</span>
        <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"GetUsers() failed: $^E"</span><span class="operator">;</span>
</pre>
<pre>
    <span class="keyword">foreach</span> <span class="operator">(</span><span class="keyword">keys</span> <span class="variable">%hash</span><span class="operator">)</span> <span class="operator">{</span>
        <span class="keyword">my</span> <span class="operator">(</span><span class="variable">$password</span><span class="operator">,</span> <span class="variable">$passwordAge</span><span class="operator">,</span> <span class="variable">$privilege</span><span class="operator">,</span>
            <span class="variable">$homeDir</span><span class="operator">,</span> <span class="variable">$comment</span><span class="operator">,</span> <span class="variable">$flags</span><span class="operator">,</span> <span class="variable">$scriptPath</span><span class="operator">);</span>
        <span class="keyword">if</span> <span class="operator">(</span><span class="variable">GroupIsMember</span><span class="operator">(</span><span class="string">""</span><span class="operator">,</span> <span class="string">"Domain Users"</span><span class="operator">,</span> <span class="variable">$_</span><span class="operator">))</span> <span class="operator">{</span>
            <span class="keyword">print</span> <span class="string">"Updating </span><span class="variable">$_</span><span class="string"> (</span><span class="variable">$hash</span><span class="string">{</span><span class="variable">$_</span><span class="string">})\n"</span><span class="operator">;</span>
            <span class="variable">UserGetAttributes</span><span class="operator">(</span><span class="string">""</span><span class="operator">,</span> <span class="variable">$_</span><span class="operator">,</span> <span class="variable">$password</span><span class="operator">,</span> <span class="variable">$passwordAge</span><span class="operator">,</span> <span class="variable">$privilege</span><span class="operator">,</span>
                              <span class="variable">$homeDir</span><span class="operator">,</span> <span class="variable">$comment</span><span class="operator">,</span> <span class="variable">$flags</span><span class="operator">,</span> <span class="variable">$scriptPath</span><span class="operator">)</span>
                <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"UserGetAttributes() failed: $^E"</span><span class="operator">;</span>
            <span class="variable">$scriptPath</span> <span class="operator">=</span> <span class="string">"dnx_login.bat"</span><span class="operator">;</span> <span class="comment"># this is the new login script</span>
            <span class="variable">UserSetAttributes</span><span class="operator">(</span><span class="string">""</span><span class="operator">,</span> <span class="variable">$_</span><span class="operator">,</span> <span class="variable">$password</span><span class="operator">,</span> <span class="variable">$passwordAge</span><span class="operator">,</span> <span class="variable">$privilege</span><span class="operator">,</span>
                              <span class="variable">$homeDir</span><span class="operator">,</span> <span class="variable">$comment</span><span class="operator">,</span> <span class="variable">$flags</span><span class="operator">,</span> <span class="variable">$scriptPath</span><span class="operator">)</span>
                <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"UserSetAttributes() failed: $^E"</span><span class="operator">;</span>
        <span class="operator">}</span>
    <span class="operator">}</span>
</pre>

</body>

</html>
