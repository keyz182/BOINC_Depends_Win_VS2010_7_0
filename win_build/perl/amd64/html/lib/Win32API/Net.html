<?xml version="1.0" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../../displayToc.js"></script>
<script language="JavaScript" src="../../tocParas.js"></script>
<script language="JavaScript" src="../../tocTab.js"></script>
<link rel="stylesheet" type="text/css" href="../../scineplex.css">
<title>Win32API::Net - Perl interface to the Windows NT LanManager API account management functions.</title>
<link rel="stylesheet" href="../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:" />
</head>

<body>


<!-- INDEX BEGIN -->
<div name="index">
<script>writelinks('__top__',2);</script>
<h1><a>Win32API::Net - Perl interface to the Windows NT LanManager API account management functions.</a></h1>
<p><a name="__index__"></a></p>


<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#note_on_versions_prior_to_0_08">NOTE ON VERSIONS PRIOR TO 0.08</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<ul>

		<li><a href="#using_references">Using References</a></li>
	</ul>

	<li><a href="#data_structures">DATA STRUCTURES</a></li>
	<li><a href="#exports">EXPORTS</a></li>
	<li><a href="#net_user_functions">NET USER FUNCTIONS</a></li>
	<ul>

		<li><a href="#useradd_server__level__hash__error_">UserAdd(server, level, hash, error)</a></li>
		<li><a href="#userchangepassword_server__user__old__new_">UserChangePassword(server, user, old, new)</a></li>
		<li><a href="#userdel_server__user_">UserDel(server, user)</a></li>
		<li><a href="#userenum_server__array___filter__">UserEnum(server, array[, filter])</a></li>
		<li><a href="#usergetgroups_server__user__array_">UserGetGroups(server, user, array)</a></li>
		<li><a href="#usergetinfo_server__user__level__hash_">UserGetInfo(server, user, level, hash)</a></li>
		<li><a href="#usergetlocalgroups_server__user__array___flags__">UserGetLocalGroups(server, user, array[, flags])</a></li>
		<li><a href="#usermodalsget__"><code>UserModalsGet()</code></a></li>
		<li><a href="#usermodalsset__"><code>UserModalsSet()</code></a></li>
		<li><a href="#usersetgroups_server__user__array_">UserSetGroups(server, user, array)</a></li>
		<li><a href="#usersetinfo_server__user__level__hash__error_">UserSetInfo(server, user, level, hash, error)</a></li>
	</ul>

	<li><a href="#net_group_functions">NET GROUP FUNCTIONS</a></li>
	<ul>

		<li><a href="#groupadd_server__level__hash__error_">GroupAdd(server, level, hash, error)</a></li>
		<li><a href="#groupadduser_server__group__user_">GroupAddUser(server, group, user)</a></li>
		<li><a href="#groupdel_server__group_">GroupDel(server, group)</a></li>
		<li><a href="#groupdeluser_server__group__user_">GroupDelUser(server, group, user)</a></li>
		<li><a href="#groupenum_server__array_">GroupEnum(server, array)</a></li>
		<li><a href="#groupgetinfo_server__group__level__hash_">GroupGetInfo(server, group, level, hash)</a></li>
		<li><a href="#groupgetusers_server__group__array_">GroupGetUsers(server, group, array)</a></li>
		<li><a href="#groupsetinfo_server__group__level__hash__error_">GroupSetInfo(server, group, level, hash, error)</a></li>
		<li><a href="#groupsetusers_server__group__array_">GroupSetUsers(server, group, array)</a></li>
	</ul>

	<li><a href="#net_local_group_functions">NET LOCAL GROUP FUNCTIONS</a></li>
	<ul>

		<li><a href="#localgroupadd_server__level__hash__error_">LocalGroupAdd(server, level, hash, error)</a></li>
		<li><a href="#localgroupaddmember__"><code>LocalGroupAddMember()</code></a></li>
		<li><a href="#localgroupaddmembers_server__group__array_">LocalGroupAddMembers(server, group, array)</a></li>
		<li><a href="#localgroupdel_server__group_">LocalGroupDel(server, group)</a></li>
		<li><a href="#localgroupdelmember__"><code>LocalGroupDelMember()</code></a></li>
		<li><a href="#localgroupdelmembers_server__group__array_">LocalGroupDelMembers(server, group, array)</a></li>
		<li><a href="#localgroupenum_server__array_">LocalGroupEnum(server, array)</a></li>
		<li><a href="#localgroupgetinfo_server__group__level__hash_">LocalGroupGetInfo(server, group, level, hash)</a></li>
		<li><a href="#localgroupgetmembers_server__group__hash_">LocalGroupGetMembers(server, group, hash)</a></li>
		<li><a href="#localgroupsetinfo_server__level__hash__error_">LocalGroupSetInfo(server, level, hash, error)</a></li>
		<li><a href="#localgroupsetmembers__"><code>LocalGroupSetMembers()</code></a></li>
	</ul>

	<li><a href="#net_get_functions">NET GET FUNCTIONS</a></li>
	<ul>

		<li><a href="#getdcname_server__domain__domain_controller_">GetDCName(server, domain, domain-controller)</a></li>
	</ul>

	<li><a href="#user_info_levels">USER INFO LEVELS</a></li>
	<li><a href="#user_info_fields">USER INFO FIELDS</a></li>
	<li><a href="#user_flags">USER FLAGS</a></li>
	<li><a href="#user_privilege_flags">USER PRIVILEGE FLAGS</a></li>
	<li><a href="#user_enum_filter">USER ENUM FILTER</a></li>
	<li><a href="#user_field_errors">USER FIELD ERRORS</a></li>
	<li><a href="#group_info_levels">GROUP INFO LEVELS</a></li>
	<li><a href="#group_info_fields">GROUP INFO FIELDS</a></li>
	<li><a href="#group_field_errors">GROUP FIELD ERRORS</a></li>
	<li><a href="#group_users_info_levels">GROUP USERS INFO LEVELS</a></li>
	<li><a href="#group_users_info_fields">GROUP USERS INFO FIELDS</a></li>
	<li><a href="#local_group_info_levels">LOCAL GROUP INFO LEVELS</a></li>
	<li><a href="#local_group_info_fields">LOCAL GROUP INFO FIELDS</a></li>
	<li><a href="#local_group_field_errors">LOCAL GROUP FIELD ERRORS</a></li>
	<li><a href="#examples">EXAMPLES</a></li>
	<li><a href="#author">AUTHOR</a></li>
	<li><a href="#see_also">SEE ALSO</a></li>
	<li><a href="#acknowedgements">ACKNOWEDGEMENTS</a></li>
</ul>

<hr name="index" />
</div>
<!-- INDEX END -->

<p>
</p>
<h1><a name="name">NAME</a></h1>
<p>Win32API::Net - Perl interface to the Windows NT LanManager API account management functions.</p>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<p>use Win32API::Net;</p>
<p>
</p>
<hr />
<h1><a name="note_on_versions_prior_to_0_08">NOTE ON VERSIONS PRIOR TO 0.08</a></h1>
<p>As of version 0.08 of this module, the behaviour relating to empty strings
in input hashes has changed. The old behaviour converted such strings to
the NULL pointer. The underlying API uses this value as an indication to
not change the value stored for a given field. This meant that you were not
able to clear (say) the logonScript field for a user using <code>UserSetInfo()</code>.</p>
<p>The new behaviour is to leave the string as an empty C string which will
allow fields to be cleared.  To pass a NULL pointer to the underlying
API call (and thus, to leave the field as it was), you need to set the
corresponding field to <a href="../../lib/pods/perlfunc.html#undef"><code>undef</code></a>.</p>
<p>WARNING: <strong>THIS IS AN INCOMPATIBLE CHANGE</strong>.
<strong>EXISTING SCRIPTS THAT RELIED ON PRIOR BEHAVIOR MAY NEED TO BE MODIFIED</strong>.</p>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p>Win32API::Net provides a more complete wrapper for the account management
parts of the NT LanManager API than do other similar packages. Most of what
you can achieve with the native C++ API is possible with this package - albeit
in a more Perl like manner by using references to pass information to and
from functions.</p>
<p>For an understanding of the environment in which these functions operate see
<a href="#data_structures">DATA STRUCTURES</a>.</p>
<p>The following groups of functions are available:</p>
<dl>
<dt><strong><a name="net_user_functions" class="item"><a href="#net_user_functions">NET USER FUNCTIONS</a></a></strong>

<dt><strong><a name="net_group_functions" class="item"><a href="#net_group_functions">NET GROUP FUNCTIONS</a></a></strong>

<dt><strong><a name="net_local_group_functions" class="item"><a href="#net_local_group_functions">NET LOCAL GROUP FUNCTIONS</a></a></strong>

<dt><strong><a name="net_get_functions" class="item"><a href="#net_get_functions">NET GET FUNCTIONS</a></a></strong>

</dl>
<p>All functions return 0 on failure and 1 on success. Use the
<code>Win32::GetLastError()</code> function to find out more information on why a
function failed. In addition, some functions that take a hash reference
to pass information in (e.g. <code>UserAdd()</code>) have a last argument that will
allow more detailed information on which key/value pair was not properly
specified.</p>
<p>
</p>
<h2><a name="using_references">Using References</a></h2>
<p>References to hashes and arrays are used throughout this package to pass
information into and out of functions.</p>
<dl>
<dt><strong><a name="using_hash_references" class="item">Using Hash References</a></strong>

<dd>
<p>Where a hash reference is required you can use anything that evaluates to a
hash reference. e.g.</p>
</dd>
<dd>
<pre>
        <span class="variable">$href</span> <span class="operator">=</span> <span class="operator">\</span><span class="variable">%someHash</span><span class="operator">;</span>
        <span class="variable">UserAdd</span><span class="operator">(</span><span class="variable">server</span><span class="operator">,</span> <span class="number">2</span><span class="operator">,</span> <span class="variable">$hRef</span><span class="operator">);</span>
</pre>
</dd>
<dd>
<p>Or more directly:</p>
</dd>
<dd>
<pre>
        <span class="variable">UserAdd</span><span class="operator">(</span><span class="variable">server</span><span class="operator">,</span> <span class="number">2</span><span class="operator">,</span> <span class="operator">\</span><span class="variable">%someHash</span><span class="operator">);</span>
</pre>
</dd>
</li>
<dt><strong><a name="using_array_references" class="item">Using Array references</a></strong>

<dd>
<p>Array references are used in a similar manner to hash references. e.g.</p>
</dd>
<dd>
<pre>
        <span class="variable">$aref</span> <span class="operator">=</span> <span class="operator">\</span><span class="variable">@someArray</span><span class="operator">;</span>
        <span class="variable">UserEnum</span><span class="operator">(</span><span class="variable">server</span><span class="operator">,</span> <span class="variable">$aref</span><span class="operator">);</span>
</pre>
</dd>
<dd>
<p>Or more directly:</p>
</dd>
<dd>
<pre>
        <span class="variable">UserEnum</span><span class="operator">(</span><span class="variable">server</span><span class="operator">,</span> <span class="operator">\</span><span class="variable">@someArray</span><span class="operator">);</span>
</pre>
</dd>
</li>
</dl>
<p>Please note: Any <code>*Get*()</code> or <code>*Enum()</code> operation will first clear the
contents of the input hash or array being referenced.</p>
<p>See <em>EXAMPLES</em> and the test.pl script for examples of usage.</p>
<p>
</p>
<hr />
<h1><a name="data_structures">DATA STRUCTURES</a></h1>
<p>Most the the functions in the underlying API allow the programmer to pass
specify at runtime the amount of information that is supplied to the
function. For example, the <code>NetUserGetInfo()</code> call allows the programmer to
specify levels of 0, 1, 2, 3 (and others). Having specified this level, the
function returns a structure that will contain different fields. For a
level <code>0</code>, the function returns a structure that has only one field. For a
supplied level of 1, the function returns a structure with <code>8</code> fields. The
programmer needs to know in advance what fields should be provided or will
be returned for a given level. This mechanism works very will since it
effectively overloads functions without having to use different function
prototypes. Perl provides better higher level data structures in the form
of arrays and hashes. This package uses hashes as the means to pass these
variable size structure into and out of functions.</p>
<p>For any function that takes a reference to a hash as input, the programmer
is expected to provide appropriate keys and corresponding values as well as
the level parameter. The called function will then takes the values out of
the supplied hash and build the approprite structure to pass to the
underlying API function.</p>
<p>For any function that takes a reference to a hash to recieve output, the
function will first clear any keys an corresponding values in the supplied
hash. It will call the underlying API call and will then return in the hash
any keys and values that are applicable at the requested level.</p>
<p>Example:</p>
<p>The <code>UserGetInfo()</code> can takes a number of levels. If called with level <code>0</code>
the supplied hash will, on return from the function, contain a single key
and value - namely <strong>name</strong>/<strong>requested-users-name</strong>. If called with a level
of <code>1</code> the supplied hash will, on return from the function, contain 8 keys
and values. The returned keys are <code>name, password</code>, <code>passwordAge</code>,
<code>priv</code>, <code>homeDir</code>, <code>comment</code>, <a href="../../lib/pods/perlfunc.html#flags"><code>flags</code></a>, <code>scriptPath</code>. See
<a href="#user_info_fields">USER INFO FIELDS</a> for more information on what these represent.</p>
<p>
</p>
<hr />
<h1><a name="exports">EXPORTS</a></h1>
<p>By default, Win32API::Net exports no symbols into the callers namespace.
The following tags can be used to selectively import symbols into the
main namespace.</p>
<dl>
<dt><strong><a name="user" class="item"><code>:User</code></a></strong>

<dd>
<p>Exports all symbols needed for the <a href="#user"><code>User*()</code></a> functions.
See <a href="#net_user_functions">NET USER FUNCTIONS</a>.</p>
</dd>
</li>
<dt><strong><a name="get2" class="item"><a href="#get"><code>:Get</code></a></a></strong>

<dd>
<p>Exports all symbols needed for the <a href="#get"><code>Get*()</code></a> functions.
See <a href="#net_get_functions">NET GET FUNCTIONS</a>.</p>
</dd>
</li>
<dt><strong><a name="group" class="item"><code>:Group</code></a></strong>

<dd>
<p>Exports all symbols needed for the <a href="#group"><code>Group*()</code></a> functions.
See <a href="#net_group_functions">NET GROUP FUNCTIONS</a>.</p>
</dd>
</li>
<dt><strong><a name="localgroup" class="item"><code>:LocalGroup</code></a></strong>

<dd>
<p>Exports all symbols needed for the <a href="#localgroup"><code>LocalGroup*()</code></a> functions.
See <a href="#net_local_group_functions">NET LOCAL GROUP FUNCTIONS</a>.</p>
</dd>
</li>
</dl>
<p>
</p>
<hr />
<h1><a name="net_user_functions">NET USER FUNCTIONS</a></h1>
<p>The <a href="#user"><code>User*()</code></a> functions operate on NT user accounts.</p>
<p>Administrator or Account Operator group membership is required to
successfully execute most of these functions on a remote server or on a
computer that has local security enabled. Administrator privileges are
required to add an Administrator Privilege account.  There are some
exceptions to this whereby a user can change some of their own settings
where these don't conflict with 'administrative information' (e.g. full
name).</p>
<p>The <code>server</code> field can be the empty string, in which case the function
defaults to running on the local computer. If you leave this field blank
then you should ensure that you are running the function on a PDC or BDC
for your current domain. Use the support function <code>GetDCName()</code> to find out
what the domain controller is, should you not be running this on the PDC.</p>
<p>All functions in this section are 'DOMAIN functions'. This means that,
for example, the <code>UserGetLocalGroups()</code> function actually lists the
domain's local groups of which the named user is a member.</p>
<p>The following functions are available.</p>
<p>
</p>
<h2><a name="useradd_server__level__hash__error_">UserAdd(server, level, hash, error)</a></h2>
<p>Add a new user account. The user name is taken from the <code>name</code>-key's
value in the supplied hash.</p>
<dl>
<dt><strong><a name="server_scalar_string" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The server on which to add the account.</p>
</dd>
</li>
<dt><strong><a name="level_scalar_int" class="item"><code>level</code> - Scalar Int</a></strong>

<dd>
<p>Level of information provided in hash. This can be either 1, 2 or 3.
See <a href="#user_info_levels">USER INFO LEVELS</a>.</p>
</dd>
</li>
<dt><strong><a name="hash_hash_reference" class="item"><code>hash</code> - Hash Reference</a></strong>

<dd>
<p>The information to use to add this account. This should have all the
appropriate keys and values required for <code>level</code>.</p>
</dd>
</li>
<dt><strong><a name="error_scalar_int" class="item"><code>error</code> - Scalar Int</a></strong>

<dd>
<p>Provides information on which field in the hash was not properly specified.
See <a href="#user_field_errors">USER FIELD ERRORS</a> for more information about what values this can
take.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="userchangepassword_server__user__old__new_">UserChangePassword(server, user, old, new)</a></h2>
<p>Changes the password for <code>user</code>. If the policy of the machine/domain
only allows password changes if the <code>user</code> is logged on then the <code>user</code>
must be logged on to execute this function. With Administrator or Account
Operator privilege you can use this function to change anyone's password,
so long as you know the old password.</p>
<dl>
<dt><strong><a name="server_scalar_string2" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The <code>server</code> on which to change the password.</p>
</dd>
</li>
<dt><strong><a name="user_scalar_string" class="item"><code>user</code> - Scalar String</a></strong>

<dd>
<p>The name of the <code>user</code> whose password is being changed.</p>
</dd>
</li>
<dt><strong><a name="old_scalar_string" class="item"><code>old</code> - Scalar String</a></strong>

<dd>
<p>The existing password for <code>user</code>.</p>
</dd>
</li>
<dt><strong><a name="new_scalar_string" class="item"><code>new</code> - Scalar String</a></strong>

<dd>
<p>The new password for <code>user</code>.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="userdel_server__user_">UserDel(server, user)</a></h2>
<p>Deletes the specified <code>user</code> account. Administrator or Account Operator
privilege is required to execute this function.</p>
<dl>
<dt><strong><a name="server_scalar_string3" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The <code>server</code> on which to delete the <code>user</code>.</p>
</dd>
</li>
<dt><strong><a name="user_scalar_string2" class="item"><code>user</code> - Scalar String</a></strong>

<dd>
<p>The <code>user</code> account to delete.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="userenum_server__array___filter__">UserEnum(server, array[, filter])</a></h2>
<p>Enumerates all the accounts on server that satisfy <code>filter</code>. Unlike the
<code>NetUserEnum()</code> function in the API, this function does not allow you
to specify a level (internally it is hardcoded to 0). In Perl it is
trivial to implement the equivalent function (should you need it) - see
<a href="#example_1">Example 1</a>.</p>
<dl>
<dt><strong><a name="server_scalar_string4" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The <code>server</code> on which to enumerate the accounts satisfying <code>filter</code>.</p>
</dd>
</li>
<dt><strong><a name="array_array_reference" class="item"><code>array</code> - Array Reference</a></strong>

<dd>
<p>The array that will hold the names of all users on <code>server</code> whose
accounts match <code>filter</code>.</p>
</dd>
</li>
<dt><strong><a name="int" class="item"><code>filter</code> - Scalar Int (optional)</a></strong>

<dd>
<p>The filter to apply (see <a href="#user_enum_filter">USER ENUM FILTER</a>). This argument is optional
and if not present a default of <a href="#filter_normal_account"><code>FILTER_NORMAL_ACCOUNT</code></a> is used.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="usergetgroups_server__user__array_">UserGetGroups(server, user, array)</a></h2>
<p>Get the global groups for which <code>user</code> is a member. It returns the group
names in <code>array</code>. Unlike the <code>NetUserGetGroups()</code> function in the API,
this function does not allow you to specify a level (internally is
hardcoded to 0). In Perl it is trivial to implement the equivalent function
(in the unlikely event that you might need it).</p>
<dl>
<dt><strong><a name="server_scalar_string5" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The <code>server</code> from which to get the groups of which <code>user</code> is a member.</p>
</dd>
</li>
<dt><strong><a name="user_scalar_string3" class="item"><code>user</code> - Scalar String</a></strong>

<dd>
<p>The <code>user</code> whose group membership you wish to examine.</p>
</dd>
</li>
<dt><strong><a name="array_scalar_string" class="item"><code>array</code> - Scalar String</a></strong>

<dd>
<p>The array that will contain the group names to which <code>user</code> belongs.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="usergetinfo_server__user__level__hash_">UserGetInfo(server, user, level, hash)</a></h2>
<p>Returns the information at the specified <code>level</code> for the named <code>user</code>
in <code>hash</code>.</p>
<dl>
<dt><strong><a name="server_scalar_string6" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The <code>server</code> from which to get the requested information about <code>user</code>.</p>
</dd>
</li>
<dt><strong><a name="user_scalar_string4" class="item"><code>user</code> - Scalar String</a></strong>

<dd>
<p>The <code>user</code> whose information you want.</p>
</dd>
</li>
<dt><strong><a name="level_scalar_int2" class="item"><code>level</code> - Scalar Int</a></strong>

<dd>
<p>One of: 0, 1, 2, 3, 10, 11 and 20. See <a href="#user_info_levels">USER INFO LEVELS</a>.</p>
</dd>
</li>
<dt><strong><a name="hash_hash_reference2" class="item"><code>hash</code> - Hash Reference</a></strong>

<dd>
<p>The hash that will contain the keys and values for the information
requested. See <a href="#user_info_fields">USER INFO FIELDS</a> for information about which keys are
present in a given level.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="usergetlocalgroups_server__user__array___flags__">UserGetLocalGroups(server, user, array[, flags])</a></h2>
<p>Gets the names of the local groups of which <code>user</code> is a member. Unlike
the <code>NetUserEnum()</code> function in the API, this function does not allow you
to specify a level. Since the underlying API restricts you to level 0 there
really isn't any need to include it...</p>
<dl>
<dt><strong><a name="server_scalar_string7" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The server from which to get the local groups of which <code>user</code> is a member.</p>
</dd>
</li>
<dt><strong><a name="user_scalar_string5" class="item"><code>user</code> - Scalar String</a></strong>

<dd>
<p>The <code>user</code> whose local group membership you wish to enumerate.</p>
</dd>
</li>
<dt><strong><a name="array_array_reference2" class="item"><code>array</code> - Array Reference</a></strong>

<dd>
<p>The array that will hold the names of the local groups to which <code>user</code>
belongs.</p>
</dd>
</li>
<dt><strong><a name="flags_scalar_int_em_optional_em" class="item"><a href="../../lib/pods/perlfunc.html#flags"><code>flags</code></a> - Scalar Int &lt;em&gt;(optional)&lt;/em&gt;</a></strong>

<dd>
<p>Either <code>Win32API::Net::LG_INCLUDE_INDIRECT()</code> or 0. if <a href="../../lib/pods/perlfunc.html#flags"><code>flags</code></a> is
omitted, the function internally uses 0. Specifying <code>LG_INCLUDE_INDIRECT()</code>
will include in the list the names of the groups of which the <code>user</code> is
indirectly a member (e.g. by being in a global group that is a member of a
local group).</p>
</dd>
<dd>
<p>This field can take no other values.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="usermodalsget__"><code>UserModalsGet()</code></a></h2>
<p>This function is not currently implemented.</p>
<p>
</p>
<h2><a name="usermodalsset__"><code>UserModalsSet()</code></a></h2>
<p>This function is not currently implemented.</p>
<p>
</p>
<h2><a name="usersetgroups_server__user__array_">UserSetGroups(server, user, array)</a></h2>
<p>Sets the (global) group membership for <code>user</code> to the specified groups.
Unlike the API function <code>NetUserSetGroups()</code>, this function does not take a
<code>level</code> parameter (mainly because this option is largely redundant).</p>
<dl>
<dt><strong><a name="server_scalar_string8" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The <code>server</code> on which you wish to set the group membership for <code>user</code>.</p>
</dd>
</li>
<dt><strong><a name="user_scalar_string6" class="item"><code>user</code> - Scalar String</a></strong>

<dd>
<p>The <code>user</code> whose group membership you wish to set.</p>
</dd>
</li>
<dt><strong><a name="array_array_reference3" class="item"><code>array</code> - Array Reference</a></strong>

<dd>
<p>The array containing the (global) group names to set the <code>user</code>s
membership of.</p>
</dd>
</li>
</dl>
<p>This function will fail if any of the group names specified do not exist.</p>
<p>
</p>
<h2><a name="usersetinfo_server__user__level__hash__error_">UserSetInfo(server, user, level, hash, error)</a></h2>
<p>Sets the info for <code>user</code> according to the information contained in <code>hash</code>
for <code>level</code> (see <a href="#user_info_levels">USER INFO LEVELS</a>).</p>
<dl>
<dt><strong><a name="server_scalar_string9" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The <code>server</code> on which you wish to change the info for <code>user</code>.</p>
</dd>
</li>
<dt><strong><a name="user_scalar_string7" class="item"><code>user</code> - Scalar String</a></strong>

<dd>
<p>The <code>user</code> whose info you wish to change.</p>
</dd>
</li>
<dt><strong><a name="level_scalar_int3" class="item"><code>level</code> - Scalar Int</a></strong>

<dd>
<p>One of 0, 1, 2, 3, or 20 (according to Microsoft documentation). In
practice, you can use all the 10xx levels as well to change most of the
individual properties of the named <code>user</code> - although this may not be
supported in future...</p>
</dd>
</li>
<dt><strong><a name="hash_hash_reference3" class="item"><code>hash</code> - Hash Reference</a></strong>

<dd>
<p>The hash that will contain the necessary key/value pairs required for
<code>level</code> (see <a href="#user_info_levels">USER INFO LEVELS</a>).</p>
</dd>
</li>
<dt><strong><a name="error_scalar_int2" class="item"><code>error</code> - Scalar Int</a></strong>

<dd>
<p>Provides information on which field in <code>hash</code> were not properly
specified. See <a href="#user_field_errors">USER FIELD ERRORS</a> for more information about what
values can be returned in this field.</p>
</dd>
</li>
</dl>
<p>
</p>
<hr />
<h1><a name="net_group_functions">NET GROUP FUNCTIONS</a></h1>
<p>The <a href="#group"><code>Group*()</code></a> functions all operate only on global groups. To modify
local groups, use the corresponding <a href="#localgroup"><code>LocalGroup*()</code></a> functions.</p>
<p>Administrator or Account Operator group membership is required to
successfully execute most of these functions on a remote server or on
a computer that has local security enabled.</p>
<p>The <code>server</code> field can be the empty string, in which case the function
defaults to running on the local computer. If you leave this field blank
then you should ensure that you are running the function on a PDC or BDC
for your current domain. Use the support function <code>GetDCName()</code> to find out
what the domain controller is, should you not be running this on the PDC.</p>
<p>The following functions are available.</p>
<p>
</p>
<h2><a name="groupadd_server__level__hash__error_">GroupAdd(server, level, hash, error)</a></h2>
<p>Adds the specified group.</p>
<dl>
<dt><strong><a name="server_scalar_string10" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The <code>server</code> on which to add the group.</p>
</dd>
</li>
<dt><strong><a name="level_scalar_string" class="item"><code>level</code> - Scalar String</a></strong>

<dd>
<p>The <code>level</code> of information contained in <code>hash</code>. This can be one of 0, 1
or 2. See <a href="#group_info_levels">GROUP INFO LEVELS</a>.</p>
</dd>
</li>
<dt><strong><a name="hash_hash_reference4" class="item"><code>hash</code> - Hash Reference</a></strong>

<dd>
<p>A hash containing the required key/value pairs for <code>level</code>.</p>
</dd>
</li>
<dt><strong><a name="error_scalar_int3" class="item"><code>error</code> - Scalar Int</a></strong>

<dd>
<p>Provides information on which field in <code>hash</code> was not properly specified.
See <a href="#group_field_errors">GROUP FIELD ERRORS</a> for more information about what values can be
returned in this field.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="groupadduser_server__group__user_">GroupAddUser(server, group, user)</a></h2>
<p>Adds the specified <code>user</code> to the specified <code>group</code>.</p>
<dl>
<dt><strong><a name="server_scalar_string11" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The <code>server</code> on which to add the <code>user</code> to <code>group</code>.</p>
</dd>
</li>
<dt><strong><a name="group_scalar_string" class="item"><code>group</code> - Scalar String</a></strong>

<dd>
<p>The <code>group</code> to add the <code>user</code> to.</p>
</dd>
</li>
<dt><strong><a name="user_scalar_string8" class="item"><code>user</code> - Scalar String</a></strong>

<dd>
<p>The <code>user</code> to add to <code>group</code>.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="groupdel_server__group_">GroupDel(server, group)</a></h2>
<p>Deletes the specified global group.</p>
<dl>
<dt><strong><a name="server_scalar_string12" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The <code>server</code> on which to delete the named <code>group</code>.</p>
</dd>
</li>
<dt><strong><a name="group_scalar_string2" class="item"><code>group</code> -Scalar String</a></strong>

<dd>
<p>The <code>group</code> to delete.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="groupdeluser_server__group__user_">GroupDelUser(server, group, user)</a></h2>
<p>Deletes the specified user from the specified group.</p>
<dl>
<dt><strong><a name="server_scalar_string13" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The <code>server</code> on which to delete <code>user</code> from <code>group</code>.</p>
</dd>
</li>
<dt><strong><a name="group_scalar_string3" class="item"><code>group</code> - Scalar String</a></strong>

<dd>
<p>The <code>group</code> from which to delete <code>user</code>.</p>
</dd>
</li>
<dt><strong><a name="user_scalar_string9" class="item"><code>user</code> - Scalar String</a></strong>

<dd>
<p>The <code>user</code> to delete from <code>group</code>.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="groupenum_server__array_">GroupEnum(server, array)</a></h2>
<p>Enumerates all the global groups on the server. Unlike the API call
<code>NetGroupEnum()</code>, this function does not allow you to specify a level
(internally it is hardcoded to 0). In Perl it is trivial to implement
the equivalent function (should you need it).</p>
<dl>
<dt><strong><a name="server_scalar_string14" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The server on which to enumerate the (global) <code>groups</code>.</p>
</dd>
</li>
<dt><strong><a name="array_array_reference4" class="item"><code>array</code> - Array Reference</a></strong>

<dd>
<p>An array that, on return, will contain the <code>group</code> names.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="groupgetinfo_server__group__level__hash_">GroupGetInfo(server, group, level, hash)</a></h2>
<p>Retrieves <code>level</code> information for <code>group</code> returning information in
<code>hash</code>.</p>
<dl>
<dt><strong><a name="server_scalar_string15" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The <code>server</code> from which to get the group information.</p>
</dd>
</li>
<dt><strong><a name="group_scalar_string4" class="item"><code>group</code> - Scalar String</a></strong>

<dd>
<p>The <code>group</code> whose information you wish to obtain.</p>
</dd>
</li>
<dt><strong><a name="level_scalar_int4" class="item"><code>level</code> - Scalar Int</a></strong>

<dd>
<p>The <code>level</code> of information you wish to retrieve. This can be one of 1, 2
or 3. See <a href="#group_info_levels">GROUP INFO LEVELS</a>.</p>
</dd>
</li>
<dt><strong><a name="hash_hash_reference5" class="item"><code>hash</code> - Hash Reference</a></strong>

<dd>
<p>The hash that will contain the information.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="groupgetusers_server__group__array_">GroupGetUsers(server, group, array)</a></h2>
<p>Returns (in <code>array</code>) the users belonging to <code>group</code>. Unlike the API
call <code>NetGroupGetUsers()</code>, this function does not allow you to specify
a level (internally it is hardcoded to 0). In Perl it is trivial to
implement the equivalent function (should you need it).</p>
<dl>
<dt><strong><a name="server_scalar_string16" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The <code>server</code> from which to get the group information.</p>
</dd>
</li>
<dt><strong><a name="group_scalar_string5" class="item"><code>group</code> - Scalar String</a></strong>

<dd>
<p>The <code>group</code> whose users you wish to obtain.</p>
</dd>
</li>
<dt><strong><a name="array_array_reference5" class="item"><code>array</code> - Array Reference</a></strong>

<dd>
<p>The array to hold the user names retrieved.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="groupsetinfo_server__group__level__hash__error_">GroupSetInfo(server, group, level, hash, error)</a></h2>
<p>Sets the information for <code>group</code> according to <code>level</code>.</p>
<dl>
<dt><strong><a name="server_scalar_string17" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The <code>server</code> on which to set the <code>group</code> information.</p>
</dd>
</li>
<dt><strong><a name="group_scalar_string6" class="item"><code>group</code> - Scalar String</a></strong>

<dd>
<p>The <code>group</code> whose information you wish to set.</p>
</dd>
</li>
<dt><strong><a name="level_scalar_int5" class="item"><code>level</code> - Scalar Int</a></strong>

<dd>
<p>The <code>level</code> of information you are supplying in <code>hash</code>.  Level can be
one of 0, 1 or 2. See <a href="#group_info_levels">GROUP INFO LEVELS</a>.</p>
</dd>
</li>
<dt><strong><a name="hash_hash_reference6" class="item"><code>hash</code> - Hash Reference</a></strong>

<dd>
<p>The hash containing the required key/value pairs for <code>level</code>.</p>
</dd>
</li>
<dt><strong><a name="error_scalar_string" class="item"><code>error</code> - Scalar String</a></strong>

<dd>
<p>On failure, the <code>error</code> parameter will contain a value which specifies
which field caused the error. See <a href="#group_field_errors">GROUP FIELD ERRORS</a>.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="groupsetusers_server__group__array_">GroupSetUsers(server, group, array)</a></h2>
<p>Sets the membership of <code>group</code> to contain only those users specified
in <code>array</code>. This function will fail if any user names contained in the
array are not valid users on <code>server</code>.  On successful completion
<code>group</code> will contain only the users specified in <code>array</code>.  Use the
functions <code>GroupAddUser()/GroupDelUser()</code> to add and delete individual
users from a group.</p>
<dl>
<dt><strong><a name="server_scalar_string18" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The <code>server</code> on which to set the <code>group</code> membership.</p>
</dd>
</li>
<dt><strong><a name="group_scalar_string7" class="item"><code>group</code> - Scalar String</a></strong>

<dd>
<p>The <code>group</code> to set the membership of.</p>
</dd>
</li>
<dt><strong><a name="array_array_reference6" class="item"><code>array</code> - Array Reference</a></strong>

<dd>
<p>The array containing the names of all users who will be members of <code>group</code>.</p>
</dd>
</li>
</dl>
<p>
</p>
<hr />
<h1><a name="net_local_group_functions">NET LOCAL GROUP FUNCTIONS</a></h1>
<p>The <a href="#localgroup"><code>LocalGroup*()</code></a> functions operate on local groups. If these
functions are run on a PDC then these functions operate on the domains
local groups.</p>
<p>Administrator or Account Operator group membership is required to
successfully execute most of these functions on a remote server or on a
computer that has local security enabled.</p>
<p>The <code>server</code> field can be the empty string, in which case the function
defaults to running on the local computer. If you leave this field blank
then you should ensure that you are running the function on a PDC or BDC
for your current domain. Use the support function <code>GetDCName()</code> to find
out what the domain controller is, should you not be running this on the PDC.</p>
<p>The following functions are available.</p>
<p>
</p>
<h2><a name="localgroupadd_server__level__hash__error_">LocalGroupAdd(server, level, hash, error)</a></h2>
<p>Adds the specified group. The name of the group is contained in the <code>name</code>
key of <code>hash</code>.</p>
<dl>
<dt><strong><a name="server_scalar_string19" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The <code>server</code> on which to add the group.</p>
</dd>
</li>
<dt><strong><a name="level_scalar_string2" class="item"><code>level</code> - Scalar String</a></strong>

<dd>
<p>The <code>level</code> of information contained in <code>hash</code>. This can be one of 0 or 1.
See <a href="#local_group_info_levels">LOCAL GROUP INFO LEVELS</a>.</p>
</dd>
</li>
<dt><strong><a name="hash_hash_reference7" class="item"><code>hash</code> - Hash Reference</a></strong>

<dd>
<p>A hash containing the required key/value pairs for <code>level</code>.</p>
</dd>
</li>
<dt><strong><a name="error_scalar_int4" class="item"><code>error</code> - Scalar Int</a></strong>

<dd>
<p>Provides information on which field in <code>hash</code> wasn't properly specified.
See <a href="#local_group_field_errors">LOCAL GROUP FIELD ERRORS</a> for more information about what values
this can take.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="localgroupaddmember__"><code>LocalGroupAddMember()</code></a></h2>
<p>This function is obselete in the underlying API and has therefore not
been implemented.  Use <code>LocalGroupAddMembers</code> instead.</p>
<p>
</p>
<h2><a name="localgroupaddmembers_server__group__array_">LocalGroupAddMembers(server, group, array)</a></h2>
<p>Adds the specified users (members) to the local group. Unlike the API
function <code>NetLocalGroupAddMembers()</code>, this function does not allow you
to specify a level (internally it is hardcoded to 3).
This was done to simplify the implementation. To add a 'local' user, you
need only specify the <code>name</code>. You can also specify users using the
<code>DOMAIN\user</code> syntax.</p>
<dl>
<dt><strong><a name="server_scalar_string20" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The <code>server</code> on which to add the members to <code>group</code>.</p>
</dd>
</li>
<dt><strong><a name="group_scalar_string8" class="item"><code>group</code> - Scalar String</a></strong>

<dd>
<p>The <code>group</code> to add the members to.</p>
</dd>
</li>
<dt><strong><a name="array_array_reference7" class="item"><code>array</code> - Array Reference</a></strong>

<dd>
<p>The array containing the members to add to <code>group</code>.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="localgroupdel_server__group_">LocalGroupDel(server, group)</a></h2>
<p>Delete the specified local group.</p>
<dl>
<dt><strong><a name="server_scalar_string21" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The <code>server</code> on which to delete the named <code>group</code>.</p>
</dd>
</li>
<dt><strong><a name="group_scalar_string9" class="item"><code>group</code> -Scalar String</a></strong>

<dd>
<p>The <code>group</code> to delete.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="localgroupdelmember__"><code>LocalGroupDelMember()</code></a></h2>
<p>This function is obselete in the underlying API and has therefore not
been implemented.  Use <code>LocalGroupDelMembers()</code> instead.</p>
<p>
</p>
<h2><a name="localgroupdelmembers_server__group__array_">LocalGroupDelMembers(server, group, array)</a></h2>
<p>Delete the specified users (members) of the local group. Unlike the API
function <code>NetLocalGroupDelMembers()</code>, this function does not allow you
to specify a level (internally it is hardcoded to 3). This was done to
simplify the implementation. To delete a 'local' user, you need only
specify the <code>name</code>. You can also specify users using the <code>DOMAIN\user</code>
syntax.</p>
<dl>
<dt><strong><a name="server_scalar_string22" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The <code>server</code> on which to delete the members from <code>group</code>.</p>
</dd>
</li>
<dt><strong><a name="group_scalar_string10" class="item"><code>group</code> - Scalar String</a></strong>

<dd>
<p>The <code>group</code> to delete the members from.</p>
</dd>
</li>
<dt><strong><a name="array_array_reference8" class="item"><code>array</code> - Array Reference</a></strong>

<dd>
<p>The array containing the members to delete from <code>group</code>.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="localgroupenum_server__array_">LocalGroupEnum(server, array)</a></h2>
<p>Enumerates all the local groups on the server. Unlike the API call
<code>NetLocalGroupEnum()</code>, this function does not allow you to specify a
level (internally it is hardcoded to 0). In Perl it is trivial to
implement the equivalent function (should you need it).</p>
<dl>
<dt><strong><a name="server_scalar_string23" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The server on which to enumerate the (local) <code>groups</code>.</p>
</dd>
</li>
<dt><strong><a name="array_array_reference9" class="item"><code>array</code> - Array Reference</a></strong>

<dd>
<p>The array to hold the <code>group</code> names.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="localgroupgetinfo_server__group__level__hash_">LocalGroupGetInfo(server, group, level, hash)</a></h2>
<p>Retrieves <code>level</code> information for <code>group</code>.</p>
<dl>
<dt><strong><a name="server_scalar_string24" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The <code>server</code> from which to get the group information.</p>
</dd>
</li>
<dt><strong><a name="group_scalar_string11" class="item"><code>group</code> - Scalar String</a></strong>

<dd>
<p>The <code>group</code> whose information you wish to obtain.</p>
</dd>
</li>
<dt><strong><a name="level_scalar_int6" class="item"><code>level</code> - Scalar Int</a></strong>

<dd>
<p>The <code>level</code> of information you wish to retrieve. This can be 0 or 1.
See <a href="#local_group_info_levels">LOCAL GROUP INFO LEVELS</a>.</p>
</dd>
</li>
<dt><strong><a name="hash_hash_reference8" class="item"><code>hash</code> - Hash Reference</a></strong>

<dd>
<p>The hash that will contain the information.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="localgroupgetmembers_server__group__hash_">LocalGroupGetMembers(server, group, hash)</a></h2>
<p>Retrieves the users belonging to <code>group</code>. Unlike the API call
<code>NetLocalGroupGetUsers()</code>, this function does not allow you to specify
a level (internally it is hardcoded to 0). In Perl it is trivial to
implement the equivalent function (should you need it).</p>
<dl>
<dt><strong><a name="server_scalar_string25" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The <code>server</code> from which to retrieve the group information.</p>
</dd>
</li>
<dt><strong><a name="group_scalar_string12" class="item"><code>group</code> - Scalar String</a></strong>

<dd>
<p>The <code>group</code> whose users you wish to obtain.</p>
</dd>
</li>
<dt><strong><a name="array_array_reference10" class="item"><code>array</code> - Array Reference</a></strong>

<dd>
<p>The array to hold the user names retrieved.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="localgroupsetinfo_server__level__hash__error_">LocalGroupSetInfo(server, level, hash, error)</a></h2>
<p>Sets the information for <code>group</code> according to <code>level</code>.</p>
<dl>
<dt><strong><a name="server_scalar_string26" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The <code>server</code> on which to set the <code>group</code> information.</p>
</dd>
</li>
<dt><strong><a name="group_scalar_string13" class="item"><code>group</code> - Scalar String</a></strong>

<dd>
<p>The <code>group</code> whose information you wish to set.</p>
</dd>
</li>
<dt><strong><a name="level_scalar_int7" class="item"><code>level</code> - Scalar Int</a></strong>

<dd>
<p>The <code>level</code> of information you are supplying in <code>hash</code>.
Level can be one of 0 or 1. See <a href="#local_group_info_levels">LOCAL GROUP INFO LEVELS</a>.</p>
</dd>
</li>
<dt><strong><a name="hash_hash_reference9" class="item"><code>hash</code> - Hash Reference</a></strong>

<dd>
<p>The hash containing the required key/value pairs for <code>level</code>.</p>
</dd>
</li>
<dt><strong><a name="error_scalar_string2" class="item"><code>error</code> - Scalar String</a></strong>

<dd>
<p>On failure, the <code>error</code> parameter will contain a value which specifies
which field caused the error. See <a href="#local_group_field_errors">LOCAL GROUP FIELD ERRORS</a>.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="localgroupsetmembers__"><code>LocalGroupSetMembers()</code></a></h2>
<p>This function has not been implemented at present.</p>
<p>
</p>
<hr />
<h1><a name="net_get_functions">NET GET FUNCTIONS</a></h1>
<p>
</p>
<h2><a name="getdcname_server__domain__domain_controller_">GetDCName(server, domain, domain-controller)</a></h2>
<p>Gets the <code>domain-controller</code> name for <code>server</code> and <code>domain</code>.</p>
<dl>
<dt><strong><a name="server_scalar_string27" class="item"><code>server</code> - Scalar String</a></strong>

<dd>
<p>The <code>server</code> whose domain controller you wish to locate.</p>
</dd>
</li>
<dt><strong><a name="domain_scalar_string" class="item"><code>domain</code> - Scalar String</a></strong>

<dd>
<p>The <code>domain</code> that <code>server</code> is a member of whose domain-controller
you wish the locate.</p>
</dd>
</li>
<dt><strong><a name="string" class="item"><code>domain-controller</code> - Scalar String (output)</a></strong>

<dd>
<p>The name of the <code>domain-controller</code> for the requested <code>domain</code>.</p>
</dd>
</li>
</dl>
<p>Note: This module does not implement the <code>NetGetAnyDCName()</code>API function
as this is obsolete.</p>
<p>
</p>
<hr />
<h1><a name="user_info_levels">USER INFO LEVELS</a></h1>
<p>Most of the <a href="#user"><code>User*()</code></a> functions take a <code>level</code> parameter. This <code>level</code>
specifies how much detail the corresponding <code>hash</code> should contain (or in
the case of a <code>UserGet*()</code> function, will contain after the call). The
following <code>level</code> descriptions provide information on what fields should
be present for a given level. See <a href="#user_info_fields">USER INFO FIELDS</a> for a description of
the fields.</p>
<dl>
<dt><strong><a name="level_0" class="item">Level 0</a></strong>

<dd>
<p>name</p>
</dd>
</li>
<dt><strong><a name="level_12" class="item">Level 1</a></strong>

<dd>
<p>name, password, passwordAge, priv, homeDir, comment, flags, scriptPath</p>
</dd>
</li>
<dt><strong><a name="level_22" class="item">Level 2</a></strong>

<dd>
<p>name, password, passwordAge, priv, homeDir, comment, flags, scriptPath,
authFlags, fullName, usrComment, parms, workstations, lastLogon,
lastLogoff, acctExpires, maxStorage, unitsPerWeek, logonHours, badPwCount,
numLogons, logonServer, countryCode, codePage</p>
</dd>
</li>
<dt><strong><a name="level_32" class="item">Level 3</a></strong>

<dd>
<p>name, password, passwordAge, priv, homeDir, comment, flags, scriptPath,
authFlags, fullName, usrComment, parms, workstations, lastLogon, lastLogoff,
acctExpires, maxStorage, unitsPerWeek, logonHours, badPwCount, numLogons,
logonServer, countryCode, codePage, userId, primaryGroupId, profile,
homeDirDrive, passwordExpired</p>
</dd>
</li>
<dt><strong><a name="level_10" class="item">Level 10</a></strong>

<dd>
<p>name, comment, usrComment, fullName</p>
</dd>
</li>
<dt><strong><a name="level_11" class="item">Level 11</a></strong>

<dd>
<p>name, comment, usrComment, fullName, priv, authFlags, passwordAge, homeDir,
parms, lastLogon, lastLogoff, badPwCount, numLogons, logonServer,
countryCode, workstations, maxStorage, unitsPerWeek, logonHours, codePage</p>
</dd>
</li>
<dt><strong><a name="level_20" class="item">Level 20</a></strong>

<dd>
<p>name, fullName, comment, flags, userId</p>
</dd>
</li>
<dt><strong><a name="level_21" class="item">Level 21</a></strong>

<dd>
<p><strong>Not available in this implementation</strong></p>
</dd>
</li>
<dt><strong>Level 22</strong>

<dd>
<p><strong>Not available in this implementation</strong></p>
</dd>
</li>
<dt><strong><a name="level_1003" class="item">Level 1003</a></strong>

<dd>
<p>password</p>
</dd>
</li>
<dt><strong><a name="level_1005" class="item">Level 1005</a></strong>

<dd>
<p>priv</p>
</dd>
</li>
<dt><strong><a name="level_1006" class="item">Level 1006</a></strong>

<dd>
<p>homeDir</p>
</dd>
</li>
<dt><strong><a name="level_1007" class="item">Level 1007</a></strong>

<dd>
<p>comment</p>
</dd>
</li>
<dt><strong><a name="level_1008" class="item">Level 1008</a></strong>

<dd>
<p>flags</p>
</dd>
</li>
<dt><strong><a name="level_1009" class="item">Level 1009</a></strong>

<dd>
<p>scriptPath</p>
</dd>
</li>
<dt><strong><a name="level_1010" class="item">Level 1010</a></strong>

<dd>
<p>authFlags</p>
</dd>
</li>
<dt><strong><a name="level_1011" class="item">Level 1011</a></strong>

<dd>
<p>fullName</p>
</dd>
</li>
<dt><strong><a name="level_1012" class="item">Level 1012</a></strong>

<dd>
<p>usrComment</p>
</dd>
</li>
<dt><strong><a name="level_1013" class="item">Level 1013</a></strong>

<dd>
<p>parms</p>
</dd>
</li>
<dt><strong><a name="level_1014" class="item">Level 1014</a></strong>

<dd>
<p>workstations</p>
</dd>
</li>
<dt><strong><a name="level_1017" class="item">Level 1017</a></strong>

<dd>
<p>acctExpires</p>
</dd>
</li>
<dt><strong><a name="level_1018" class="item">Level 1018</a></strong>

<dd>
<p>maxStorage</p>
</dd>
</li>
<dt><strong><a name="level_1020" class="item">Level 1020</a></strong>

<dd>
<p>unitsPerWeek, logonHours</p>
</dd>
</li>
<dt><strong><a name="level_1023" class="item">Level 1023</a></strong>

<dd>
<p>logonServer</p>
</dd>
</li>
<dt><strong><a name="level_1024" class="item">Level 1024</a></strong>

<dd>
<p>countryCode</p>
</dd>
</li>
<dt><strong><a name="level_1025" class="item">Level 1025</a></strong>

<dd>
<p>codePage</p>
</dd>
</li>
<dt><strong><a name="level_1051" class="item">Level 1051</a></strong>

<dd>
<p>primaryGroupId</p>
</dd>
</li>
<dt><strong><a name="level_1052" class="item">Level 1052</a></strong>

<dd>
<p>profile</p>
</dd>
</li>
<dt><strong><a name="level_1053" class="item">Level 1053</a></strong>

<dd>
<p>homeDirDrive</p>
</dd>
</li>
</dl>
<p>
</p>
<hr />
<h1><a name="user_info_fields">USER INFO FIELDS</a></h1>
<p>The following is an alphabetical listing of each possible field, together
with the data type that the field is expected to contain.</p>
<dl>
<dt><strong><code>acctExpires</code> - Scalar Int (UTC)</strong>

<dd>
<p>The time (as the number of seconds since 00:00:00, 1st January 1970) when
the account expires. A -1 in this field specifies that the account never
expires.</p>
</dd>
</li>
<dt><strong><code>authFlags</code> - Scalar Int (See USER_AUTH_FLAGS).</strong>

<dd>
<p>The level of authority that this use has. The value this can take depends
on the users group membership - this value is therefore read only and
cannot be set using <code>UserAdd()</code> or <code>UserSetInfo()</code>. Its value can be one
of:</p>
</dd>
</li>
</dl>
<pre>
        User belongs to group           Flag value
        ---------------------           ----------
        Print Operators                 Win32API::Net::AF_OP_PRINT()
        Server Operators                Win32API::Net::AF_OP_SERVER()
        Account Operators               Win32API::Net::AF_OP_ACCOUNTS()</pre>
<dl>
<dt><strong><a name="badpwcount_scalar_int" class="item"><code>badPwCount</code> - Scalar Int</a></strong>

<dd>
<p>The number of times that the user has failed to logon by specifying an
incorrect password.</p>
</dd>
</li>
<dt><strong><a name="codepage_scalar_int" class="item"><code>codePage</code> - Scalar Int</a></strong>

<dd>
<p>The code page that this user uses.</p>
</dd>
</li>
<dt><strong><a name="comment_scalar_string" class="item"><code>comment</code> - Scalar String</a></strong>

<dd>
<p>The comment associated with this user account. This can be any string
(apparently of any length).</p>
</dd>
</li>
<dt><strong><a name="countrycode_scalar_int" class="item"><code>countryCode</code> - Scalar Int</a></strong>

<dd>
<p>The country code that this user uses.</p>
</dd>
</li>
<dt><strong><a href="../../lib/pods/perlfunc.html#flags"><code>flags</code></a> - Scalar Int (Bitwise OR of USER_FLAGS)</strong>

<dd>
<p>The flags for this user. See <a href="#user_flags">USER FLAGS</a>.</p>
</dd>
</li>
<dt><strong><a name="fullname_scalar_string" class="item"><code>fullName</code> - Scalar String</a></strong>

<dd>
<p>The users' full name.</p>
</dd>
</li>
<dt><strong><a name="homedir_scalar_string" class="item"><code>homeDir</code> - Scalar String</a></strong>

<dd>
<p>The home directory of the user. This can be either a UNC path or an
absolute path (drive letter + path). Can be the empty string (&quot;&quot;).</p>
</dd>
</li>
<dt><strong><a name="homedirdrive_scalar_string" class="item"><code>homeDirDrive</code> - Scalar String</a></strong>

<dd>
<p>The home directory drive that the users home directory is mapped to
(assuming that the specified home directory is a UNC path).</p>
</dd>
</li>
<dt><strong><code>lastLogon</code> - Scalar Int (UTC)</strong>

<dd>
<p>The time (as the number of seconds since 00:00:00, 1st January 1970)
that the user last logged on.</p>
</dd>
</li>
<dt><strong><code>lastLogoff</code> - Scalar Int (UTC)</strong>

<dd>
<p>The time (as the number of seconds since 00:00:00, 1st January 1970)
that the user last logged off .</p>
</dd>
</li>
<dt><strong><a name="integers" class="item"><code>logonHours</code> - Reference to Array of Integers (length 21 elements)</a></strong>

<dd>
<p>The times at which the user can logon. This should be an integer array
with 21 elements.  Each element represents an 8 hour period and each bit
represents represents an hour. Only the lower byte of each integer is
used. If this is left undefined then no restrictions are placed on the
account.</p>
</dd>
</li>
<dt><strong><a name="logonserver_scalar_string" class="item"><code>logonServer</code> - Scalar String</a></strong>

<dd>
<p>The logon server for this user. Under Windows NT, this value cannot be
set and will always have the value '\\*' when queried.</p>
</dd>
</li>
<dt><strong><a name="maxstorage_scalar_int" class="item"><code>maxStorage</code> - Scalar Int</a></strong>

<dd>
<p>The current release of Windows NT does not implement disk quotas so
it is believed that the value of this key is ignored.</p>
</dd>
</li>
<dt><strong><a name="name_scalar_string" class="item"><code>name</code> - Scalar String</a></strong>

<dd>
<p>The user name that this request applies to. Most of the functions take
the user name as a separate argument. In general, the user name provided
should be the same as that in the one provided in the hash.</p>
</dd>
</li>
<dt><strong><a name="numlogons_scalar_int" class="item"><code>numLogons</code> - Scalar Int</a></strong>

<dd>
<p>The number of times that the named user has successfully logged on to
this machine/domain.</p>
</dd>
</li>
<dt><strong><a name="parms_scalar_string" class="item"><code>parms</code> - Scalar String</a></strong>

<dd>
<p>The value of this key can be used by applications. There are none known
to to author that use it, although it could be used to hold adminitrative
information.</p>
</dd>
</li>
<dt><strong><a name="password_scalar_string" class="item"><code>password</code> - Scalar String</a></strong>

<dd>
<p>The password to be set. The password is never returned in a <code>UserGet()</code>
operation.</p>
</dd>
</li>
<dt><strong><code>passwordAge</code> - Scalar Int (UTC)</strong>

<dd>
<p>The current age of the password (stored as the number of seconds since
00:00:00, 1st January 1970).</p>
</dd>
</li>
<dt><strong><a name="passwordexpired_scalar_int" class="item"><code>passwordExpired</code> - Scalar Int</a></strong>

<dd>
<p>The value of this key is used in two different ways. When queried via
<code>UserGetInfo()</code> the return value is 0 is the password has not expired
and 1 if it has. When setting the value via <code>UserAdd()</code> or
<code>UserSetInfo()</code> a value of 0 indicates that the users' password has
not expired whereas a value of 1 will force the user to change their
password at the next logon.</p>
</dd>
</li>
<dt><strong><a name="primarygroupid_scalar_int" class="item"><code>primaryGroupId</code> - Scalar Int</a></strong>

<dd>
<p>The id of the primary group that this user belongs to. When creating
accounts with <code>UserAdd()</code> you should use a value of 0x201.</p>
</dd>
</li>
<dt><strong><code>priv</code> - Scalar Int (Bitwise OR of USER_PRIVILEGE_FLAGS)</strong>

<dd>
<p>The privilege level that this user has. This is never returned from a
<code>UserGet()</code> call. See <a href="#user_privilege_flags">USER PRIVILEGE FLAGS</a>.</p>
</dd>
</li>
<dt><strong><a name="profile_scalar_string" class="item"><code>profile</code> - Scalar String</a></strong>

<dd>
<p>The profile that is associated with the named user. This can be UNC path,
a local path or undefined.</p>
</dd>
</li>
<dt><strong><a name="scriptpath_scalar_string" class="item"><code>scriptPath</code> - Scalar String</a></strong>

<dd>
<p>The path to the logon script for this user. This should be specified as a
relative path and will cause the logon script to be run from (relative
location) in the logon servers export directory.</p>
</dd>
</li>
<dt><strong><a name="unitsperweek_scalar_int" class="item"><code>unitsPerWeek</code> - Scalar Int</a></strong>

<dd>
<p>The value of this key represents the granularity of the logonHours array.
Its use is beyond the scope of this package.</p>
</dd>
</li>
<dt><strong><a name="usrcomment_scalar_string" class="item"><code>usrComment</code> - Scalar String</a></strong>

<dd>
<p>The user comment field (contrasted with the comment field ;-).</p>
</dd>
</li>
<dt><strong><a name="workstations_scalar_string" class="item"><code>workstations</code> - Scalar String</a></strong>

<dd>
<p>A comma-separated string containing upto 8 workstation that the named
user can login to.  Setting a value for this key will then allow the
named user to login to only those computers named.</p>
</dd>
</li>
<dt><strong><a name="userid_scalar_int" class="item"><code>userId</code> - Scalar Int</a></strong>

<dd>
<p>The user id associated with this user This value is generated by the
system and cannot be set or changed using the <code>UserAdd()</code> or
<code>UserSetInfo()</code> calls.</p>
</dd>
</li>
</dl>
<p>
</p>
<hr />
<h1><a name="user_flags">USER FLAGS</a></h1>
<p>The following is an alphabetical listing of the user flags.
The <a href="../../lib/pods/perlfunc.html#flags"><code>flags</code></a> key (see <a href="#user_info_fields">USER INFO FIELDS</a>) should be the bitwise OR of one
or more of these values.</p>
<dl>
<dt><strong><a name="uf_accountdisable" class="item"><code>UF_ACCOUNTDISABLE()</code></a></strong>

<dd>
<p>This account has been disabled.</p>
</dd>
</li>
<dt><strong><a name="uf_dont_expire_passwd" class="item"><code>UF_DONT_EXPIRE_PASSWD()</code></a></strong>

<dd>
<p>Never expire the password on this account.</p>
</dd>
</li>
<dt><strong><a name="uf_homedir_required" class="item"><code>UF_HOMEDIR_REQUIRED()</code></a></strong>

<dd>
<p>A home directory must be specified (ignored for NT).</p>
</dd>
</li>
<dt><strong><a name="uf_interdomain_trust_account" class="item"><code>UF_INTERDOMAIN_TRUST_ACCOUNT()</code></a></strong>

<dd>
<p>The account represents a interdomain trust account.</p>
</dd>
</li>
<dt><strong><a name="uf_lockout" class="item"><code>UF_LOCKOUT()</code></a></strong>

<dd>
<p>Lock out this account (or this account has been locked out due to
security policy - i.e.  badLogonCount is greater than your policy allows).
This value can be cleared but not set by a <code>UserSetInfo()</code> call.</p>
</dd>
</li>
<dt><strong><a name="uf_normal_account" class="item"><code>UF_NORMAL_ACCOUNT()</code></a></strong>

<dd>
<p>The account is a normal user account.</p>
</dd>
</li>
<dt><strong><a name="uf_passwd_cant_change" class="item"><code>UF_PASSWD_CANT_CHANGE()</code></a></strong>

<dd>
<p>The password for this account cannot be changed (execpt by an Administrator
using one of the above calls).</p>
</dd>
</li>
<dt><strong><a name="uf_passwd_notreqd" class="item"><code>UF_PASSWD_NOTREQD()</code></a></strong>

<dd>
<p>A password is not required for this account.</p>
</dd>
</li>
<dt><strong><a name="uf_script" class="item"><code>UF_SCRIPT()</code></a></strong>

<dd>
<p>This &lt;strong&gt;must be set when creating account on Windows NT.</p>
</dd>
</li>
<dt><strong><a name="uf_server_trust_account" class="item"><code>UF_SERVER_TRUST_ACCOUNT()</code></a></strong>

<dd>
<p>The account represents a Windows NT Backup Domain Controller account in
the domain.</p>
</dd>
</li>
<dt><strong><a name="uf_temp_duplicate_account" class="item"><code>UF_TEMP_DUPLICATE_ACCOUNT()</code></a></strong>

<dd>
<p>To quote the Microsoft Documentation &lt;em&gt;&amp;quot;This is an account for
users whose primary account is in another domain. This account provides
user access to this domain, but not to any domain that trusts this domain.
The User Manager refers to this account type as a local user account.</p>
</dd>
</li>
<dt><strong><a name="uf_workstation_trust_account" class="item"><code>UF_WORKSTATION_TRUST_ACCOUNT()</code></a></strong>

<dd>
<p>The account represents a computer account for a workstation or server in
the domain.</p>
</dd>
</li>
</dl>
<p>Please note that these are implemented as functions and are therefore
called in the same way as other functions. You should typically use them
like:</p>
<pre>
        <span class="variable">$ufScript</span> <span class="operator">=</span> <span class="variable">Win32API::Net::UF_SCRIPT</span><span class="operator">();</span>
</pre>
<p>
</p>
<hr />
<h1><a name="user_privilege_flags">USER PRIVILEGE FLAGS</a></h1>
<p>These following values are used in the <code>priv</code> key. This field is never
initialised on a <code>UserGet*()</code> call and once set cannot be changed in a
<code>UserSetInfo()</code> call.</p>
<dl>
<dt><strong><a name="user_priv_admin" class="item"><code>USER_PRIV_ADMIN()</code></a></strong>

<dd>
<p>Account is an an administrative account.</p>
</dd>
</li>
<dt><strong><a name="user_priv_guest" class="item"><code>USER_PRIV_GUEST()</code></a></strong>

<dd>
<p>Account is a guest account.</p>
</dd>
</li>
<dt><strong><a name="user_priv_user" class="item"><code>USER_PRIV_USER()</code></a></strong>

<dd>
<p>Account is a user account.</p>
</dd>
</li>
</dl>
<p>Please note that these are implemented as functions and are therefore
called in the same way as other functions. You should typically use them
like:</p>
<pre>
        <span class="variable">$userPrivUser</span> <span class="operator">=</span> <span class="variable">Win32API::Net::USER_PRIV_USER</span><span class="operator">();</span>
</pre>
<p>
</p>
<hr />
<h1><a name="user_enum_filter">USER ENUM FILTER</a></h1>
<p>These flags are used in the <code>UserEnum()</code> function to specify which
accounts to retrieve. It should be a bitwise OR of some (or all) of
the following.</p>
<dl>
<dt><strong><a name="filter_temp_duplicate_account" class="item"><code>FILTER_TEMP_DUPLICATE_ACCOUNT()</code></a></strong>

<dd>
<p>Show temporary duplicate account (one presumes).</p>
</dd>
</li>
<dt><strong><a name="filter_normal_account" class="item"><code>FILTER_NORMAL_ACCOUNT()</code></a></strong>

<dd>
<p>Show normal user account.</p>
</dd>
</li>
<dt><strong><a name="filter_interdomain_trust_account" class="item"><code>FILTER_INTERDOMAIN_TRUST_ACCOUNT()</code></a></strong>

<dd>
<p>Show interdomain trust accounts.</p>
</dd>
</li>
<dt><strong><a name="filter_workstation_trust_account" class="item"><code>FILTER_WORKSTATION_TRUST_ACCOUNT()</code></a></strong>

<dd>
<p>Show workstation trust accounts.</p>
</dd>
</li>
<dt><strong><a name="filter_server_trust_account" class="item"><code>FILTER_SERVER_TRUST_ACCOUNT()</code></a></strong>

<dd>
<p>Show server trust accounts.</p>
</dd>
</li>
</dl>
<p>Please note that these are implemented as functions and are therefore
called in the same way as other functions. You should typically use them
like:</p>
<pre>
        <span class="variable">$filterNormalAccounts</span> <span class="operator">=</span> <span class="variable">Win32API::Net::FILTER_NORMAL_ACCOUNT</span><span class="operator">();</span>
</pre>
<p>
</p>
<hr />
<h1><a name="user_field_errors">USER FIELD ERRORS</a></h1>
<p>For the <a href="#user"><code>User*()</code></a> functions that take an <code>error</code> parameter this variable
will, on failure, contain one of the following constants. Note that the
function may fail because more than one key/value was missing from the
input hash. You will only find out about the first one that was incorrectly
specified. This is only really useful in debugging.</p>
<dl>
<dt><strong><a name="user_acct_expires_parmnum" class="item"><code>USER_ACCT_EXPIRES_PARMNUM()</code></a></strong>

<dd>
<p><code>acctExpires</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_auth_flags_parmnum" class="item"><code>USER_AUTH_FLAGS_PARMNUM()</code></a></strong>

<dd>
<p><code>authFlags</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_bad_pw_count_parmnum" class="item"><code>USER_BAD_PW_COUNT_PARMNUM()</code></a></strong>

<dd>
<p><code>badPasswordCount</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_code_page_parmnum" class="item"><code>USER_CODE_PAGE_PARMNUM()</code></a></strong>

<dd>
<p><code>codePage</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_comment_parmnum" class="item"><code>USER_COMMENT_PARMNUM()</code></a></strong>

<dd>
<p><code>comment</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_country_code_parmnum" class="item"><code>USER_COUNTRY_CODE_PARMNUM()</code></a></strong>

<dd>
<p><code>countryCode</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_flags_parmnum" class="item"><code>USER_FLAGS_PARMNUM()</code></a></strong>

<dd>
<p><a href="../../lib/pods/perlfunc.html#flags"><code>flags</code></a> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_full_name_parmnum" class="item"><code>USER_FULL_NAME_PARMNUM()</code></a></strong>

<dd>
<p><code>fullName</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_home_dir_drive_parmnum" class="item"><code>USER_HOME_DIR_DRIVE_PARMNUM()</code></a></strong>

<dd>
<p><code>homeDirDrive</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_home_dir_parmnum" class="item"><code>USER_HOME_DIR_PARMNUM()</code></a></strong>

<dd>
<p><code>homeDir</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_last_logoff_parmnum" class="item"><code>USER_LAST_LOGOFF_PARMNUM()</code></a></strong>

<dd>
<p><code>lastLogoff</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_last_logon_parmnum" class="item"><code>USER_LAST_LOGON_PARMNUM()</code></a></strong>

<dd>
<p><code>lastLogon</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_logon_hours_parmnum" class="item"><code>USER_LOGON_HOURS_PARMNUM()</code></a></strong>

<dd>
<p><code>logonHours</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_logon_server_parmnum" class="item"><code>USER_LOGON_SERVER_PARMNUM()</code></a></strong>

<dd>
<p><code>logonServer</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_max_storage_parmnum" class="item"><code>USER_MAX_STORAGE_PARMNUM()</code></a></strong>

<dd>
<p><code>maxStorage</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_name_parmnum" class="item"><code>USER_NAME_PARMNUM()</code></a></strong>

<dd>
<p><code>name</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_num_logons_parmnum" class="item"><code>USER_NUM_LOGONS_PARMNUM()</code></a></strong>

<dd>
<p><code>numLogons</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_parms_parmnum" class="item"><code>USER_PARMS_PARMNUM()</code></a></strong>

<dd>
<p><code>parms</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_password_age_parmnum" class="item"><code>USER_PASSWORD_AGE_PARMNUM()</code></a></strong>

<dd>
<p><code>passwordAge</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_password_parmnum" class="item"><code>USER_PASSWORD_PARMNUM()</code></a></strong>

<dd>
<p><code>password</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_primary_group_parmnum" class="item"><code>USER_PRIMARY_GROUP_PARMNUM()</code></a></strong>

<dd>
<p><code>primaryGroup</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_priv_parmnum" class="item"><code>USER_PRIV_PARMNUM()</code></a></strong>

<dd>
<p><code>priv</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_profile_parmnum" class="item"><code>USER_PROFILE_PARMNUM()</code></a></strong>

<dd>
<p><code>profile</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_script_path_parmnum" class="item"><code>USER_SCRIPT_PATH_PARMNUM()</code></a></strong>

<dd>
<p><code>scriptPath</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_units_per_week_parmnum" class="item"><code>USER_UNITS_PER_WEEK_PARMNUM()</code></a></strong>

<dd>
<p><code>unitPerWeek</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_usr_comment_parmnum" class="item"><code>USER_USR_COMMENT_PARMNUM()</code></a></strong>

<dd>
<p><code>usrComment</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="user_workstations_parmnum" class="item"><code>USER_WORKSTATIONS_PARMNUM()</code></a></strong>

<dd>
<p><code>workstations</code> field was absent or not correctly specified.</p>
</dd>
</li>
</dl>
<p>
</p>
<hr />
<h1><a name="group_info_levels">GROUP INFO LEVELS</a></h1>
<p>Some of the <a href="#group"><code>Group*()</code></a> functions take a <code>level</code> parameter. This <code>level</code>
specifies how much detail the corresponding <code>hash</code> should contain (or in
the case of a <code>GroupGetInfo()</code> function, will contain after the call).
The following <code>level</code> descriptions provide information on what fields
should be present for a given level. See <a href="#group_info_fields">GROUP INFO FIELDS</a>
for a description of the fields.</p>
<dl>
<dt><strong><a name="level_02" class="item"><a href="#level_0"><code>Level 0</code></a></a></strong>

<dd>
<p>name.</p>
</dd>
</li>
<dt><strong><a name="level_13" class="item"><a href="#level_1"><code>Level 1</code></a></a></strong>

<dd>
<p>name, comment.</p>
</dd>
</li>
<dt><strong><a name="level_23" class="item"><a href="#level_2"><code>Level 2</code></a></a></strong>

<dd>
<p>name, comment, groupId, attributes.</p>
</dd>
</li>
<dt><strong><a name="level_1002" class="item"><code>Level 1002</code></a></strong>

<dd>
<p>comment.</p>
</dd>
</li>
<dt><strong><a name="level_10052" class="item"><a href="#level_1005"><code>Level 1005</code></a></a></strong>

<dd>
<p>attributes.</p>
</dd>
</li>
</dl>
<p>
</p>
<hr />
<h1><a name="group_info_fields">GROUP INFO FIELDS</a></h1>
<dl>
<dt><strong><a name="attributes_scalar_int" class="item"><code>attributes</code> - Scalar Int</a></strong>

<dd>
<p>The attributes of the group. These are no longer settable in Windows NT 4.0
and they are not currently supported in this package either.</p>
</dd>
</li>
<dt><strong><a name="comment_scalar_string2" class="item"><code>comment</code> - Scalar String</a></strong>

<dd>
<p>The <code>comment</code> that applies to this group. This is the only value that
can be set via a GroupSetInfo call.</p>
</dd>
</li>
<dt><strong><a name="groupid_scalar_int" class="item"><code>groupId</code> - Scalar Int</a></strong>

<dd>
<p>The groups Id.</p>
</dd>
</li>
<dt><strong><a name="name_scalar_string2" class="item"><code>name</code> - Scalar String</a></strong>

<dd>
<p>The groups name.</p>
</dd>
</li>
</dl>
<p>
</p>
<hr />
<h1><a name="group_field_errors">GROUP FIELD ERRORS</a></h1>
<p>For the <a href="#group"><code>Group*()</code></a> functions that take an <code>error</code> parameter
this variable will, on failure, contain one of the following constants.
Note that the function may fail because more than one key/value was
missing from the input hash. You will only find out about the first one
that was incorrectly specified. This is only really useful for debugging
purposes.</p>
<dl>
<dt><strong><a name="group_attributes_parmnum" class="item"><code>GROUP_ATTRIBUTES_PARMNUM()</code></a></strong>

<dd>
<p><code>attributes</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="group_comment_parmnum" class="item"><code>GROUP_COMMENT_PARMNUM()</code></a></strong>

<dd>
<p><code>comment</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="group_name_parmnum" class="item"><code>GROUP_NAME_PARMNUM()</code></a></strong>

<dd>
<p><code>name</code> field was absent or not correctly specified.</p>
</dd>
</li>
</dl>
<p>
</p>
<hr />
<h1><a name="group_users_info_levels">GROUP USERS INFO LEVELS</a></h1>
<p>The <code>GroupGetUsers()</code> function can take a level of 0 or 1. These will
return the following:</p>
<dl>
<dt><strong><a name="level_03" class="item"><a href="#level_0"><code>Level 0</code></a></a></strong>

<dd>
<p>name.</p>
</dd>
</li>
<dt><strong><a name="level_14" class="item"><a href="#level_1"><code>Level 1</code></a></a></strong>

<dd>
<p>name, attributes.</p>
</dd>
</li>
</dl>
<p>
</p>
<hr />
<h1><a name="group_users_info_fields">GROUP USERS INFO FIELDS</a></h1>
<dl>
<dt><strong><a name="name_scalar_string3" class="item"><code>name</code> - Scalar String</a></strong>

<dd>
<p>The user's name.</p>
</dd>
</li>
<dt><strong><a name="attributes_scalar_int2" class="item"><code>attributes</code> - Scalar Int</a></strong>

<dd>
<p>The attributes of the group. These are no longer settable in Windows NT
4.0 and they are not currently supported in this package either.</p>
</dd>
</li>
</dl>
<p>
</p>
<hr />
<h1><a name="local_group_info_levels">LOCAL GROUP INFO LEVELS</a></h1>
<dl>
<dt><strong><a name="level_04" class="item"><a href="#level_0"><code>Level 0</code></a></a></strong>

<dd>
<p>name</p>
</dd>
</li>
<dt><strong><a name="level_15" class="item"><a href="#level_1"><code>Level 1</code></a></a></strong>

<dd>
<p>name, comment</p>
</dd>
</li>
<dt><strong><a name="level_10022" class="item"><a href="#level_1002"><code>Level 1002</code></a></a></strong>

<dd>
<p>comment</p>
</dd>
</li>
</dl>
<p>
</p>
<hr />
<h1><a name="local_group_info_fields">LOCAL GROUP INFO FIELDS</a></h1>
<dl>
<dt><strong><a name="name_scalar_string4" class="item"><code>name</code> - Scalar String</a></strong>

<dd>
<p>The groups name</p>
</dd>
</li>
<dt><strong><a name="comment_scalar_string3" class="item"><code>comment</code> - Scalar String</a></strong>

<dd>
<p>The groups 'comment'</p>
</dd>
</li>
</dl>
<p>
</p>
<hr />
<h1><a name="local_group_field_errors">LOCAL GROUP FIELD ERRORS</a></h1>
<p>For the <a href="#localgroup"><code>LocalGroup*()</code></a> functions that take an <code>error</code> parameter this
variable will, on failure, contain one of the following constants. Note
that the function may fail because more than one key/value was missing
or incorrectly specified in the input hash. You will only find out about
the first one that was incorrectly specified. This is only really useful
for debugging purposes.</p>
<dl>
<dt><strong><a name="localgroup_name_parmnum" class="item"><code>LOCALGROUP_NAME_PARMNUM()</code></a></strong>

<dd>
<p>The <code>name</code> field was absent or not correctly specified.</p>
</dd>
</li>
<dt><strong><a name="localgroup_comment_parmnum" class="item"><code>LOCALGROUP_COMMENT_PARMNUM()</code></a></strong>

<dd>
<p>The <code>comment</code> field wasabsent or not correctly specified.</p>
</dd>
</li>
</dl>
<p>
</p>
<hr />
<h1><a name="examples">EXAMPLES</a></h1>
<p>The following example shows how you can create a function in Perl that
has the same functionality as the <code>NetUserEnum()</code> API call. The Perl
version doesn't have the level parameter so you must first use the
<code>UserEnum()</code> function to retrieve all the account names and then iterate
through the returned array issuing <code>UserGetInfo()</code> calls.</p>
<pre>
    <span class="keyword">sub</span><span class="variable"> userEnumAtLevel </span><span class="operator">{</span>
       <span class="keyword">my</span><span class="operator">(</span><span class="variable">$server</span><span class="operator">,</span> <span class="variable">$level</span><span class="operator">,</span> <span class="variable">$filter</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">@_</span><span class="operator">;</span>
       <span class="keyword">my</span><span class="operator">(</span><span class="variable">@array</span><span class="operator">);</span>
       <span class="variable">Win32API::Net::UserEnum</span><span class="operator">(</span><span class="variable">$server</span><span class="operator">,</span> <span class="operator">\</span><span class="variable">@array</span><span class="operator">,</span> <span class="variable">$filter</span><span class="operator">);</span>
       <span class="keyword">for</span> <span class="variable">$user</span> <span class="operator">(</span><span class="variable">@array</span><span class="operator">)</span> <span class="operator">{</span>
          <span class="variable">Win32API::Net::UserGetInfo</span><span class="operator">(</span><span class="variable">$server</span><span class="operator">,</span> <span class="variable">$user</span><span class="operator">,</span> <span class="variable">$level</span><span class="operator">,</span> <span class="operator">\</span><span class="variable">%hash</span><span class="operator">);</span>
          <span class="keyword">print</span> <span class="string">"This could access all level </span><span class="variable">$level</span><span class="string"> settings for </span><span class="variable">$user</span><span class="string"> - eg fullName </span><span class="variable">$hash</span><span class="string">{fullName}\n"</span><span class="operator">;</span>
       <span class="operator">}</span>
    <span class="operator">}</span>
    <span class="variable">userEnumAtLevel</span><span class="operator">(</span><span class="string">""</span><span class="operator">,</span> <span class="number">2</span><span class="operator">,</span> <span class="number">0</span><span class="operator">);</span>
</pre>
<p>
</p>
<hr />
<h1><a name="author">AUTHOR</a></h1>
<p>Bret Giddings, &lt;<a href="mailto:bret@essex.ac.uk">bret@essex.ac.uk</a>&gt;</p>
<p>
</p>
<hr />
<h1><a name="see_also">SEE ALSO</a></h1>
<p><code>perl(1)</code></p>
<p>
</p>
<hr />
<h1><a name="acknowedgements">ACKNOWEDGEMENTS</a></h1>
<p>This work was built upon work done by HiP Communications along with
modifications to HiPs code by &lt;<a href="mailto:michael@ecel.uwa.edu.au">michael@ecel.uwa.edu.au</a>&gt; and &lt;<a href="mailto:rothd@roth.net">rothd@roth.net</a>&gt;.
In addition, I would like to thank Jenny Emby at GEC Marconi, U.K. for
proof reading this manual page and making many suggestions that have led
to its current layout. Last but not least I would like to thank Larry Wall
and all the other Perl contributors for making this truly wonderful
language.</p>

</body>

</html>
